{% extends 'registrations/admin/base.html' %}
{% load static %}

{% block page_title %}Reconcile Payment{% endblock %}

{% block content %}
<div class="fade-in-up">
  <div style="max-width: 560px; margin: 0 auto;">
    <h2 class="table-title" style="margin-bottom: 8px;">Reconcile a payment</h2>
    <p style="color: hsl(var(--admin-muted-foreground)); font-size: 14px; margin-bottom: 24px;">
      If a payment succeeded on Squad but does not appear in Transactions (e.g. webhook was missed), paste the payment reference below. We will verify it with Squad and then update the registration, create the transaction record, and send the confirmation email.
    </p>
    <form method="post" style="background: hsl(var(--card)); border: 1px solid hsl(var(--border)); border-radius: 12px; padding: 24px;">
      {% csrf_token %}
      <label style="display: block; font-weight: 600; margin-bottom: 8px;">Payment reference</label>
      <input
        type="text"
        name="reference"
        placeholder="e.g. ASPIR-REG-cbd4c34b-0522-4259-ac79-d4faf3cf8f61-1770290722"
        style="width: 100%; padding: 12px 14px; border: 1px solid hsl(var(--border)); border-radius: 8px; font-family: monospace; font-size: 14px;"
        value="{{ request.POST.reference }}"
      >
      <div style="margin-top: 20px; display: flex; gap: 12px;">
        <button type="submit" class="btn btn-primary">Verify and reconcile</button>
        <a href="{% url 'admin_payment_activity' %}" class="btn btn-secondary">Cancel</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
